#!/bin/bash

pkg_mgr() {
  # set bin path
  bin='/usr/bin'
  [[ -d $bin ]] || bin='/data/data/com.termux/files/usr/bin'

  # set package manager by *distro*
  declare -gA args distro
  distro[arch]='pacman'
  distro[debian]='apt'
  [[ -f $bin/yay ]] && distro[arch]='yay'

  # check if package manager exist
  pkgMgr="${distro[$1]}"
  [[ -f $bin/$pkgMgr ]]
} # pkg_mgr

# set our first arguments
case $1 in
  -a|install) a="$1" ;;
  -i|show) i="$1" ;;
  -l) l="$1" ;;
  -la) la="$1" ;;
  -s|search) s="$1" ;;
  -d|delete|rmv|remove|uninstall) d="$1" ;;
  -u|update) u="$1" ;;
esac

# set package manager arguments per our argumentss
if pkg_mgr arch ; then
  args=( 
    [${a:-add}]='-S'
    [${i:-info}]='-Si --color=auto'
    [${l:-list}]='-Qe --color=auto'
    [${la:-list-all}]='-Q --color=auto'
    [${s:-look}]='-Ss --color=auto'
    [${d:-del}]='-Runss'
    [${u:-sync}]='-Syu'
  ) # args
elif pkg_mgr debian ; then
  args=( 
    [${a:-add}]='install'
    [${i:-info}]='show'
    [${l:-list}]='list --installed'
    [${la:-list-all}]='list'
    [${s:-look}]='search'
    [${d:-del}]='purge'
    [${u:-sync}]='update
      -y full-upgrade
      -y autoremove' # sync
  ) # args
fi

# run each argument with package manager
while IFS=$'\n' read -r arg ; do
  $pkgMgr $arg ${@/$1}
done <<< ${args[${1:-sync}]}
